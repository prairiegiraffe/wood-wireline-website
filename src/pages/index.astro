---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Stats from '~/components/widgets/Stats.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
// import TestimonialsWidget from '~/components/widgets/Testimonials.astro'; // HIDDEN UNTIL CLIENT READY
import Brands from '~/components/widgets/Brands.astro';
import Image from '~/components/common/Image.astro';
import TablerIcon from '~/components/ui/TablerIcon.astro';

// Partner logos
import logoConocoPhillips from '~/assets/images/partner-logos/ConocoPhillips-Logo.svg';
import logoContinental from '~/assets/images/partner-logos/Continental Resources.svg';
import logoDevon from '~/assets/images/partner-logos/Devon logo.svg';
import logoEOG from '~/assets/images/partner-logos/EOG-logo.svg';
import logoExxon from '~/assets/images/partner-logos/Exxon.svg';
import logoSchlumberger from '~/assets/images/partner-logos/schlumberger.svg';
import logoAEC from '~/assets/images/partner-logos/AEC.svg';

const metadata = {
  title: 'Wood Wireline — Efficient. Reliable. Ready.',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- Hero Section ******************* -->

  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'Get Quote',
        href: '/contact',
        icon: 'tabler:phone',
      },
      {
        variant: 'secondary',
        text: 'Our Services',
        href: '/services',
      },
    ]}
  >
    <Fragment slot="title">
      <span class="text-gray-900 dark:text-white">WOOD WIRELINE</span><br />
      <span class="text-gray-900 dark:text-white text-2xl md:text-3xl font-normal mt-4 block"
        >Efficient. Reliable. Ready.</span
      >
    </Fragment>

    <Fragment slot="bg">
      <video
        id="hero-video"
        autoplay
        loop
        muted
        playsinline
        preload="auto"
        class="absolute inset-0 w-full h-full object-cover opacity-50 dark:opacity-30"
        aria-hidden="true"
        onloadedmetadata="this.play()"
      >
        <source src="/WW - Website Background Loop - 10.mp4" type="video/mp4" />
      </video>
      <div class="absolute inset-0 bg-gradient-to-b from-black/42 via-black/30 to-black/42"></div>
    </Fragment>
  </Hero>

  <script is:inline>
    // Force video to play on mobile devices
    document.addEventListener('DOMContentLoaded', () => {
      const video = document.getElementById('hero-video');
      if (video) {
        // Try to play the video
        const playPromise = video.play();

        if (playPromise !== undefined) {
          playPromise
            .then(() => {
              // Video is playing
              console.log('Video autoplay started');
            })
            .catch((_error) => {
              // Autoplay was prevented
              console.log('Video autoplay prevented, attempting fallback');

              // Try playing on user interaction
              const playOnInteraction = () => {
                video.play();
                document.removeEventListener('touchstart', playOnInteraction);
                document.removeEventListener('click', playOnInteraction);
              };

              document.addEventListener('touchstart', playOnInteraction, { once: true });
              document.addEventListener('click', playOnInteraction, { once: true });
            });
        }
      }
    });
  </script>

  <!-- Trusted By Section ******************* -->

  <Brands
    tagline="Trusted By"
    title="Partnered With Industry Leaders"
    subtitle="We're proud to serve major operators and energy companies throughout the Rocky Mountain region. Our commitment to excellence has earned the trust of the industry's most respected names."
    images={[
      { src: logoConocoPhillips, alt: 'ConocoPhillips' },
      { src: logoContinental, alt: 'Continental Resources' },
      { src: logoDevon, alt: 'Devon Energy' },
      { src: logoEOG, alt: 'EOG Resources' },
      { src: logoExxon, alt: 'ExxonMobil' },
      { src: logoSchlumberger, alt: 'Schlumberger' },
      { src: logoAEC, alt: 'AEC' },
    ]}
  >
    <Fragment slot="bg">
      <div
        class="absolute inset-0 bg-gradient-to-b from-white via-gray-50 to-white dark:from-transparent dark:via-transparent dark:to-transparent"
      >
      </div>
    </Fragment>
  </Brands>

  <!-- Enhanced Stats Widget (Metrics Bar) ****************** -->

  <Stats
    title="Wood Wireline by the Numbers"
    isDark={true}
    stats={[
      {
        title: 'Years Experience',
        amount: '500+',
        subtitle: 'Years of combined industry expertise',
      },
      {
        title: 'Annual Job Completions',
        amount: '2,000+',
        subtitle: 'Successfully completed every year',
      },
      {
        title: 'Specialized Units',
        amount: '40+',
        subtitle: 'Fleet tailored for oil & gas',
      },
      {
        title: 'Service Footprint',
        amount: '4',
        subtitle: 'Locations serving 6 states',
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0">
        <Image
          src="~/assets/images/All Images/Industrial Machinery Close Up-HTHLs-7YAI.webp"
          alt="Industrial machinery background"
          class="w-full h-full object-cover"
          widths={[800, 1200, 1920]}
          sizes="100vw"
        />
        <div class="absolute inset-0 bg-black/75"></div>
      </div>
    </Fragment>
  </Stats>

  <!-- Company Introduction Section ******************* -->

  <section class="py-16 md:py-24 bg-white dark:bg-gray-800">
    <div class="max-w-5xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-8">
        <p class="text-base font-semibold text-secondary dark:text-blue-200 uppercase tracking-wide mb-2">
          Established 1977
        </p>
        <h2 class="text-3xl md:text-4xl font-bold tracking-tight dark:text-white mb-6">
          The Leading Wireline Service Company
        </h2>
      </div>
      <div class="prose prose-lg dark:prose-invert max-w-none text-muted dark:text-slate-300">
        <p class="text-lg md:text-xl leading-relaxed mb-4">
          Established in 1977, we have built our reputation on an unwavering commitment to being the leading service
          company in every basin we operate. Our crews are among the most efficient in wireline, ready to deliver
          results from the moment we cross the cattle guard. Our mission is not simply to meet expectations, but to
          consistently exceed them.
        </p>
        <div id="see-more-content" class="hidden">
          <p class="text-lg md:text-xl leading-relaxed mb-4">
            We primarily serve the Williston, Bakken, DJ, Big Horn and Powder River Basins, offering a comprehensive
            range of services including Slickline, E-line, Swabbing, Hydrotesting, and our newest addition, Slick
            E-line. With decades of hands-on experience, we understand what it takes to provide solutions that stand the
            test of time.
          </p>
          <p class="text-lg md:text-xl leading-relaxed">
            Safety is the foundation of our operations. Every project is carried out with precision, efficiency, and the
            highest safety standards. This dedication is how we have built and continue to uphold our reputation: by
            doing the job right, every single time.
          </p>
        </div>
        <button
          id="see-more-btn"
          class="mt-4 text-primary dark:text-blue-400 font-semibold hover:underline focus:outline-none inline-flex items-center"
        >
          <span id="see-more-text">See More</span>
          <svg
            id="see-more-icon"
            class="w-4 h-4 ml-1 transition-transform"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
      </div>
    </div>
  </section>

  <script is:inline>
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('see-more-btn');
      const content = document.getElementById('see-more-content');
      const text = document.getElementById('see-more-text');
      const icon = document.getElementById('see-more-icon');

      if (btn && content && text && icon) {
        btn.addEventListener('click', () => {
          const isHidden = content.classList.contains('hidden');
          if (isHidden) {
            content.classList.remove('hidden');
            text.textContent = 'See Less';
            icon.style.transform = 'rotate(180deg)';
          } else {
            content.classList.add('hidden');
            text.textContent = 'See More';
            icon.style.transform = 'rotate(0deg)';
          }
        });
      }
    });
  </script>

  <!-- Image Breakup Section ******************* -->

  <section class="relative h-80 md:h-96">
    <Image
      src="~/assets/images/All Images/Oil Field Operations.webp"
      alt="Wood Wireline field operations"
      class="absolute inset-0 w-full h-full object-cover object-center"
      widths={[800, 1200, 1920]}
      sizes="100vw"
    />
    <div class="absolute inset-0 bg-gradient-to-r from-primary/20 to-secondary/20"></div>
  </section>

  <!-- Testimonials Section ******************* -->
  <!-- HIDDEN UNTIL CLIENT READY
  <TestimonialsWidget
    title="Trusted by Industry Leaders"
    subtitle="Don't just take our word for it. Here's what operators say about working with Wood Wireline."
    tagline="Client Testimonials"
    testimonials={[
      {
        testimonial: `Wood Wireline has been our go-to service provider for years. Their crews are professional, efficient, and always show up ready to work. They've never let us down, and their attention to detail is unmatched. When we need wireline services, we call Wood Wireline.`,
        name: 'Operations Manager',
        job: 'Major Operator, Williston Basin',
      },
      {
        testimonial: `What sets Wood Wireline apart is their attention to detail and commitment to safety. They get the job done right the first time, every time. Their crews are among the most efficient we've worked with. No excuses, no downtime—just results.`,
        name: 'Company Man',
        job: 'Independent Operator, Powder River Basin',
      },
      {
        testimonial: `We've worked with Wood Wireline across multiple basins, and their consistency and reliability are unmatched. They understand what it takes to keep operations moving, and they deliver on their promises. Their crews show up ready from the moment they cross the cattle guard.`,
        name: 'Field Supervisor',
        job: 'Regional Operator',
      },
    ]}
  />
  -->

  <!-- Services Overview Section ******************* -->

  <section class="py-16 md:py-24 bg-white dark:bg-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <p class="text-base font-semibold text-secondary dark:text-blue-200 uppercase tracking-wide mb-2">
          What We Offer
        </p>
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight dark:text-white mb-6">Wireline Services</h2>
        <p class="text-xl text-muted dark:text-slate-300 max-w-3xl mx-auto">
          From formation evaluation to plug and abandonment, we deliver the full spectrum of wireline capabilities your
          operations demand.
        </p>
      </div>

      <!-- Services Carousel -->
      <div class="flex items-center gap-4 mb-8">
        <!-- Left Arrow -->
        <button
          id="services-prev"
          class="hidden md:flex flex-shrink-0 w-12 h-12 bg-black rounded-full shadow-lg items-center justify-center text-white hover:bg-gray-900 transition-colors"
          aria-label="Previous service"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>

        <!-- Scrollable Container -->
        <div
          id="services-carousel"
          class="flex gap-6 overflow-x-auto snap-x snap-mandatory scrollbar-hide pb-4 flex-1"
          style="scroll-behavior: smooth;"
        >
          <a
            href="/services/#e-line"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-primary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:chart-line" className="w-6 h-6 text-primary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">E-Line</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Complete E-Line services including advanced logging tools, pipe recovery systems, perforating
              capabilities, and plug/packer setting.
            </p>
          </a>

          <a
            href="/services/#slickline"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-secondary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-secondary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:settings" className="w-6 h-6 text-secondary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">Slickline</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Professional slickline services including quick rig units, memory logging, and H2S capabilities for well
              intervention.
            </p>
          </a>

          <a
            href="/services/#swabbing"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-primary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:droplet" className="w-6 h-6 text-primary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">Swabbing</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Enclosed cab swab rigs with hydraulic systems for safe, efficient well cleanup and fluid removal
              operations.
            </p>
          </a>

          <a
            href="/services/#tcp"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-secondary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-secondary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:rocket" className="w-6 h-6 text-secondary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">TCP</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Full TCP capabilities including pipe recovery, plug setting, and frac support for underbalanced and long
              interval operations.
            </p>
          </a>

          <a
            href="/services/#kinley"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-primary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:cut" className="w-6 h-6 text-primary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">Kinley Cutter</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Sand line cutters for stuck line recovery and horizontal operations with variable timer options to reduce
              NPT.
            </p>
          </a>

          <a
            href="/services/#hydrotesting"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-secondary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-secondary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:gauge" className="w-6 h-6 text-secondary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">Hydrotesting</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Complete testing services up to 15,000 psi with no-drop slip tools for all pipe types and sizes.
            </p>
          </a>

          <a
            href="/services/#slick-eline"
            class="group flex-shrink-0 w-[300px] md:w-[350px] bg-gray-50 dark:bg-gray-900 rounded-xl p-6 md:p-8 hover:shadow-xl transition-all border-l-4 border-primary snap-start"
          >
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mr-4">
                <TablerIcon name="tabler:cable" className="w-6 h-6 text-primary" />
              </div>
              <h3 class="text-xl md:text-2xl font-bold dark:text-white">Slick E-Line</h3>
            </div>
            <p class="text-base text-muted dark:text-slate-400 leading-relaxed">
              Our newest addition: 25,000' Inconel line with H2S capabilities and real-time production logging.
            </p>
          </a>
        </div>

        <!-- Right Arrow -->
        <button
          id="services-next"
          class="hidden md:flex flex-shrink-0 w-12 h-12 bg-black rounded-full shadow-lg items-center justify-center text-white hover:bg-gray-900 transition-colors"
          aria-label="Next service"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>

      <div class="text-center">
        <a href="/services" class="btn-primary inline-flex items-center">
          View All Services <span class="ml-2">→</span>
        </a>
      </div>

      <script>
        // Use a function to initialize carousel that can be called multiple times safely
        function initServicesCarousel() {
          const carousel = document.getElementById('services-carousel');
          const prevBtn = document.getElementById('services-prev');
          const nextBtn = document.getElementById('services-next');

          if (!carousel || !prevBtn || !nextBtn) {
            return;
          }

          const scrollAmount = 370; // Card width + gap

          // Define handlers
          const handlePrevClick = (e: Event) => {
            e.preventDefault();
            const currentScroll = carousel.scrollLeft;
            carousel.scrollTo({
              left: currentScroll - scrollAmount,
              behavior: 'smooth',
            });
          };

          const handleNextClick = (e: Event) => {
            e.preventDefault();
            const currentScroll = carousel.scrollLeft;
            carousel.scrollTo({
              left: currentScroll + scrollAmount,
              behavior: 'smooth',
            });
          };

          // Remove any existing listeners before adding new ones (cleanup)
          // We clone and replace to remove all event listeners
          const newPrevBtn = prevBtn.cloneNode(true) as HTMLElement;
          const newNextBtn = nextBtn.cloneNode(true) as HTMLElement;

          if (prevBtn.parentNode && nextBtn.parentNode) {
            prevBtn.parentNode.replaceChild(newPrevBtn, prevBtn);
            nextBtn.parentNode.replaceChild(newNextBtn, nextBtn);

            // Add event listeners to the new buttons
            newPrevBtn.addEventListener('click', handlePrevClick);
            newNextBtn.addEventListener('click', handleNextClick);
          }
        }

        // Initialize on page load and after view transitions
        initServicesCarousel();

        // Re-initialize after Astro view transitions (client-side navigation)
        document.addEventListener('astro:page-load', initServicesCarousel);
      </script>

      <style is:inline>
        .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
      </style>
    </div>
  </section>

  <!-- Image Breakup Section 2 ******************* -->

  <section class="relative h-80 md:h-96">
    <Image
      src="~/assets/images/All Images/Construction Worker Onsite.webp"
      alt="Wood Wireline construction worker onsite"
      class="absolute inset-0 w-full h-full object-cover object-center"
      widths={[800, 1200, 1920]}
      sizes="100vw"
    />
    <div class="absolute inset-0 bg-gradient-to-r from-secondary/20 to-primary/20"></div>
  </section>

  <!-- Leadership Section ******************* -->

  <section class="py-16 md:py-24 bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12 md:mb-16">
        <p class="text-base font-semibold text-secondary dark:text-blue-200 uppercase tracking-wide mb-2">Leadership</p>
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight dark:text-white mb-4">Executive Team</h2>
        <p class="text-xl text-muted dark:text-slate-300 max-w-3xl mx-auto">
          Decades of combined wireline operations and business management experience.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div
          class="group bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all border-t-4 border-primary"
        >
          <div class="relative h-72 overflow-hidden">
            <Image
              src="~/assets/images/team/Dusty.jpg"
              alt="Dusty Wood - Wireline Engineer/VP"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
              widths={[400, 600]}
              sizes="(max-width: 768px) 100vw, 33vw"
            />
          </div>
          <div class="p-6">
            <h3 class="text-2xl font-bold dark:text-white mb-1">Dusty Wood</h3>
            <p class="text-primary font-semibold mb-2">Wireline Engineer/VP</p>
            <div class="space-y-1 text-sm text-muted dark:text-slate-400">
              <p><strong>Experience:</strong> 22 Years</p>
              <p><strong>Joined Wood:</strong> 2003</p>
              <p><strong>Specialty:</strong> E-Line/Pipe Recovery</p>
            </div>
          </div>
        </div>

        <div
          class="group bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all border-t-4 border-secondary"
        >
          <div class="relative h-72 overflow-hidden">
            <Image
              src="~/assets/images/team/Tiffany.jpg"
              alt="Tiffany Wood-Nelson - Corporate Treasurer"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
              widths={[400, 600]}
              sizes="(max-width: 768px) 100vw, 33vw"
            />
          </div>
          <div class="p-6">
            <h3 class="text-2xl font-bold dark:text-white mb-1">Tiffany Wood-Nelson</h3>
            <p class="text-secondary font-semibold mb-2">Corporate Treasurer</p>
            <div class="space-y-1 text-sm text-muted dark:text-slate-400">
              <p><strong>Experience:</strong> 19 Years</p>
              <p><strong>Joined Wood:</strong> 2006</p>
            </div>
          </div>
        </div>

        <div
          class="group bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all border-t-4 border-primary"
        >
          <div class="relative h-72 overflow-hidden">
            <Image
              src="~/assets/images/team/Justin.jpg"
              alt="Justin Hargens - Operations Manager/VP"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
              widths={[400, 600]}
              sizes="(max-width: 768px) 100vw, 33vw"
            />
          </div>
          <div class="p-6">
            <h3 class="text-2xl font-bold dark:text-white mb-1">Justin Hargens</h3>
            <p class="text-primary font-semibold mb-2">Operations Manager/VP</p>
            <div class="space-y-1 text-sm text-muted dark:text-slate-400">
              <p><strong>Experience:</strong> 22 Years</p>
              <p><strong>Joined Wood:</strong> 2006</p>
              <p><strong>Specialty:</strong> Slickline</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Call to Action ******************* -->

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'Request Quote',
        href: '/contact',
        icon: 'tabler:phone',
      },
      {
        text: 'View Locations',
        href: '/contact/#map',
        variant: 'secondary',
      },
    ]}
  >
    <Fragment slot="title">
      Ready to Get Started?<br class="hidden sm:block" />
      <span class="sm:whitespace-nowrap">Let's Talk.</span>
    </Fragment>

    <Fragment slot="subtitle">
      Contact Wood Wireline for professional wireline services across the Powder River, Williston, Bakken, DJ, and Big
      Horn basins. Available 24/7 at 307-682-0143.
    </Fragment>
  </CallToAction>
</Layout>
